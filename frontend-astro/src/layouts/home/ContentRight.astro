---
import server_url from "../../config/serverUrl.json";
import { fetchPostsList } from "../../api/data";

let response: { meta: any; items: any[] } | undefined;
let popularPost: any[] | undefined;
try {
  response = await fetchPostsList(
    "blog.BlogPage",
    "description,date_post,feed_image,categories(name),author",
    "-first_published_at"
  );
  popularPost = response.items.slice(0, 5);

  // Process the response
} catch (error) {
  console.error("Error fetching data:", error);
  // Handle the error or show a user-friendly message
}

// const popularPost = await fetchPostsList(
//   "blog.BlogPage",
//   "description,date_post,feed_image,categories(name),author",
//   "-first_published_at"
// ).then(e => e.items.slice(0,5));
---

<div class="col-lg-4 col-md-4 col-sm-4">
  <aside class="right_content">
    <div class="single_sidebar">
      <h2><span>Popular Post</span></h2>
      {
        popularPost && (
          <ul class="spost_nav">
            {popularPost.map((item: any, index: number) => (
              <li>
                <div class="media wow fadeInDown">
                  <a href={item.meta.slug} class="media-left">
                    <img
                      alt={item.title}
                      src={`${server_url.server}${item.feed_image.meta.download_url}`}
                    />
                  </a>
                  <div class="media-body">
                    <a href={item.meta.slug} class="catg_title">
                      {item.title}
                    </a>
                  </div>
                </div>
              </li>
            ))}
          </ul>
        )
      }
    </div>
    <div class="single_sidebar">
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active">
          <a href="#category" aria-controls="home" role="tab" data-toggle="tab"
            >Category</a
          >
        </li>
        <li role="presentation">
          <a href="#video" aria-controls="profile" role="tab" data-toggle="tab"
            >Video</a
          >
        </li>
        <li role="presentation">
          <a
            href="#comments"
            aria-controls="messages"
            role="tab"
            data-toggle="tab">Comments</a
          >
        </li>
      </ul>
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="category">
          <ul>
            <li class="cat-item"><a href="#">Sports</a></li>
            <li class="cat-item"><a href="#">Fashion</a></li>
            <li class="cat-item"><a href="#">Business</a></li>
            <li class="cat-item"><a href="#">Technology</a></li>
            <li class="cat-item"><a href="#">Games</a></li>
            <li class="cat-item"><a href="#">Life &amp; Style</a></li>
            <li class="cat-item"><a href="#">Photography</a></li>
          </ul>
        </div>
        <div role="tabpanel" class="tab-pane" id="video">
          <div class="vide_area">
            <iframe
              width="100%"
              height="250"
              src="http://www.youtube.com/embed/h5QWbURNEpA?feature=player_detailpage"
              frameborder="0"
              allowfullscreen></iframe>
          </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="comments">
          <ul class="spost_nav">
            <li>
              <div class="media wow fadeInDown">
                <a href="pages/single_page.html" class="media-left">
                  <img alt="" src="images/post_img1.jpg" />
                </a>
                <div class="media-body">
                  <a href="pages/single_page.html" class="catg_title">
                    Aliquam malesuada diam eget turpis varius 1</a
                  >
                </div>
              </div>
            </li>
            <li>
              <div class="media wow fadeInDown">
                <a href="pages/single_page.html" class="media-left">
                  <img alt="" src="images/post_img2.jpg" />
                </a>
                <div class="media-body">
                  <a href="pages/single_page.html" class="catg_title">
                    Aliquam malesuada diam eget turpis varius 2</a
                  >
                </div>
              </div>
            </li>
            <li>
              <div class="media wow fadeInDown">
                <a href="pages/single_page.html" class="media-left">
                  <img alt="" src="images/post_img1.jpg" />
                </a>
                <div class="media-body">
                  <a href="pages/single_page.html" class="catg_title">
                    Aliquam malesuada diam eget turpis varius 3</a
                  >
                </div>
              </div>
            </li>
            <li>
              <div class="media wow fadeInDown">
                <a href="pages/single_page.html" class="media-left">
                  <img alt="" src="images/post_img2.jpg" />
                </a>
                <div class="media-body">
                  <a href="pages/single_page.html" class="catg_title">
                    Aliquam malesuada diam eget turpis varius 4</a
                  >
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="single_sidebar wow fadeInDown">
      <h2><span>Sponsor</span></h2>
      <a class="sideAdd" href="#"><img src="images/add_img.jpg" alt="" /></a>
    </div>
    <div class="single_sidebar wow fadeInDown">
      <h2><span>Category Archive</span></h2>
      <select class="catgArchive">
        <option>Select Category</option>
        <option>Life styles</option>
        <option>Sports</option>
        <option>Technology</option>
        <option>Treads</option>
      </select>
    </div>
    <div class="single_sidebar wow fadeInDown">
      <h2><span>Links</span></h2>
      <ul>
        <li><a href="#">Blog</a></li>
        <li><a href="#">Rss Feed</a></li>
        <li><a href="#">Login</a></li>
        <li><a href="#">Life &amp; Style</a></li>
      </ul>
    </div>
  </aside>
</div>
